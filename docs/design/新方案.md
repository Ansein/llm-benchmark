### 新方案：面向“隐私外部性成因理解与量化”的 LLM Benchmark（对齐 ICDE baseline）

> 目标：仿照 ICDE baseline（`Beyond Equilibrium...`）的评测方式，把其余论文做成**可复现、可量化、可横向比较不同 LLM** 的 benchmark 套件。  
> 约束：**不让 LLM 直接“报均衡/报阈值/报推导结果”**，而是让 LLM 作为市场参与者做**行动决策**；真值由 solver 计算；偏离用统一统计协议评估。

---

### 1) 设计原则（必须全场景统一）

- **论文忠实优先（Faithfulness）**：每个场景先实现论文的“最小可执行模型（MEM）”，尽量不引入论文未讨论的机制（支付规则、合约承诺、信息设计等）。任何简化必须写成显式假设，并用对照实验验证“不改核心结论方向”。
- **LLM 做决策，环境算后果（Decision-First）**：LLM 输出行动（share / price / partner / anonymize / stop-search…），环境根据行动与随机性生成**可评分的结果指标**。
- **理论基准驱动（Theory-anchored）**：每个场景必须提供可计算的理论基准（BNE、或 first-best、或论文命题条件下的政策基准），所有量化比较都围绕“偏离理论基准”展开。
- **统一偏离度量 + 统计（ICDE-style）**：对关键指标向量 \(q\) 计算 **MAE vs 理论基准**，并做多次重复（≥10）输出置信区间（68%/90% 或 bootstrap CI）。
- **解释不靠主观（Reproducible Interpretability）**：解释题用“要点表 + 重要性分档 + 多次抽样取众数 + Kendall/Jaccard 稳定性”实现可复现的解释评估（借鉴 ICDE 的 factor-importance / decision-chain pipeline）。

---

### 2) 统一的 Benchmark 协议（跨场景共用）

#### 2.1 统一对象与接口（概念层）

- **ScenarioSpec**：场景名、参数空间、行动空间、输出指标 schema、解释要点表 schema
- **InstanceGenerator**：分层抽样参数（按外部性强度分桶），生成 instance（含随机种子）
- **Solver**：
  - **solve_theory(instance)**：理论基准（BNE/FB/政策基准）
  - **rollout_with_agents(instance, agent_backends, T)**：多轮仿真（LLM/理性/混合）
  - **counterfactuals(instance, policies)**：政策反事实（关停、税、去相关、匿名化等）
- **Evaluator**：
  - **score_decision**：行动是否合理/一致（离散准确率或约束违反率）
  - **score_outcome_deviation**：关键指标对理论基准的 MAE（可归一化）
  - **score_explanation**：机制要点覆盖 + 逻辑硬约束 + 稳定性

#### 2.2 统一三类任务（每个实例都生成）

- **Task A：Decision（决策型）**
  - 输入：结构化环境信息（参数 + 当前状态/历史 + 可行动集合）
  - 输出：严格 JSON 的行动（例如 `{"share":0/1}`, `{"price":...}`, `{"partner":true}`）
  - 评分：是否满足约束（价格≥成本、action 可行）、与理性策略一致性（可选）

- **Task B：Deviation（偏离型，主评分）**
  - 输入：由环境跑完得到的一组指标（或由 evaluator 计算）
  - 输出：**不用 LLM 输出**（直接算）
  - 评分：对每个关键指标 \(q\) 计算 \(MAE(M,q)=\frac{1}{T}\sum_t |q^\* - q_{M,t}|\)

- **Task C：Explain（机制解释型）**
  - 输入：同一实例的关键信息 + LLM 自己给出的决策理由（或决策日志）
  - 输出：`{"keypoints":[...], "factor_ranks":{...}, "decision_chain":[...]}`
  - 评分：
    - 要点覆盖率（rubric）
    - 硬错误（例如“匿名化支持个性化定价”）一票否决/重扣
    - 稳定性：同输入多次调用的一致性（Kendall τ、Jaccard）

#### 2.3 统一“同质 vs 异质”配置（对齐 ICDE RQ2）

- **同质（Homogeneous）**：消费者与企业都用同一 LLM
- **异质（Heterogeneous）**：消费者用弱模型、企业用强模型（或反过来）；或混合理性/LLM
- **阶段开关（Stage Switch）**：像 ICDE 一样可按阶段替换（share/price/search 或对应场景阶段）

---

### 3) 场景集（Environment Families）

> 说明：每个“环境族”都要输出一组尽量可对齐的核心指标：  
> **行动强度**（share rate / partner rate / anonymize rate）、**价格/费率**、**外部性载体**、**消费者剩余**、**企业/中介剩余**、**社会福利**、**效率损失/偏离度**。

#### 环境族 A（Baseline）：Rhodes & Zhou / ICDE —— 隐私选择外部性（推荐 + 搜索成本）

- **机制主线（解释题必考点）**：
  - 更多人分享 → 企业能更提价 → 不分享者被迫付更高价/更多搜索 → 分享激励上升 → 过度分享（负外部性链）
- **阶段**：share → price → search/buy（与 ICDE 一致）
- **理论基准**：BNE \((\sigma^\*, p^\*)\) + 由理论导出的 surplus
- **核心指标（与 ICDE 完全同构）**：\(\sigma, p_{avg}, SC, S_c, S_f, SW\)
- **用途定位**：全套 benchmark 的“主轴”，其余环境族尽量在指标与统计上对齐它。

#### 环境族 B：Acemoglu et al. “Too Much Data” —— 推断外部性（相关性泄露 → 数据价格压低 → 过度分享）

- **机制主线（必考点）**：
  - 他人分享提升平台对你类型的推断精度 → 你的边际隐私保护价值下降 → 数据价格被压低 → 市场导致过度分享/福利损失  
  - 根源：**leaked information 的次模性（submodularity）**
- **最小可执行模型（MEM）建议**：
  - 相关高斯类型 \(X\sim N(0,\Sigma)\)，分享信号 \(S_i=X_i+\epsilon_i\)
  - 外部性载体：\(I_i(a)=\text{Var}(X_i)-\text{Var}(X_i|S_{\text{shared}})\)（MSE 降低）
  - 小 n（如 8–12）允许枚举分享集合得到理论基准（均衡/一阶最优）
- **理论基准**：均衡分享集合/价格（或平台出价）+ 一阶最优 + 关停/税/去相关对照
- **核心指标（对齐 ICDE 结构）**：
  - share_rate、avg_data_price、avg_leakage、consumer_surplus、platform_surplus、social_welfare
- **政策模块（Policy task）**：
  - 关停（shutdown）
  - Pigouvian 税（实现 first-best）
  - 去相关/中介共享（mediated de-correlation）

#### 环境族 C：Bergemann–Bonatti–Gan “Economics of Social Data” —— 社会数据外部性（匿名化 ⇔ 社会剩余）

- **机制主线（必考点）**：
  - 个体数据是社会数据：一个人的信号对他人行为可预测 → 数据外部性影响中介收数成本与信息价值
  - **匿名化（不传身份）相当于只卖“市场级信息”，从而不支持个性化定价**
  - “中介选择匿名化 if and only if 匿名化提高社会剩余”（论文的 general result / Proposition 8 方向）
- **MEM 建议**：
  - 中介从消费者收信号，选择数据政策 \(X\in\{S(身份),A(匿名)\}\)
  - 生产者根据收到的信息选择价格形式（个性化 vs 市场级）
- **理论基准**：给定数据结构与参数，中介最优数据政策 + 对应福利
- **核心指标**：
  - anonymize_choice（0/1）
  - price_form_consistency（是否允许个性化）
  - intermediary_profit、consumer_surplus、producer_profit、social_welfare
  - proposition8_consistency（“更赚钱 ⇔ 更有效率”的一致性标签）

#### 环境族 D：“To Partner or Not to Partner?” —— 两边市场传导（隐私担忧软化广告侧竞争）

- **机制主线（必考点）**：
  - 合作提升定向能力（广告侧价值↑），但提升隐私担忧（消费者侧效用↓）
  - 负跨边网络效应使平台为避免用户流失而在广告侧竞争不那么激烈 → **广告价可能上升**（软化竞争）
  - 可能出现 **囚徒困境**
  - 纯广告模式 vs 混合收费模式下消费者福利方向不同（论文强调）
- **MEM 建议**：
  - 两阶段：平台是否合作（Y/N）→ 给定合作结构解二阶段定价 → 回到一阶段找均衡结构（NN/YN/YY）
  - 模式开关：`ad_only` vs `mixed`
- **理论基准**：合作结构均衡标签 + 价格/需求/福利
- **核心指标**：
  - regime_label（NN/YN/YY）
  - ad_price、consumer_mass、consumer_surplus、platform_profit、social_welfare
  - mechanism_chain_score（能否推出“隐私担忧↑→广告侧竞争软化→广告价↑”）

#### （可选）环境族 E：Data-enabled learning —— 动态数据外部性 / 政策预期效应

- **纳入条件**：如果你的论文主线要扩展到“外部性一般均衡推理/动态政策预期”，再加入；否则先不做，避免稀释“隐私外部性”主题。
- **必考点**：政策“意外发生 vs 可预期”对消费者剩余方向可能相反（前期竞争强度变化）

---

### 4) 数据集与难度设计（让结果可发表）

- **分层抽样（外部性强度分桶）**
  - 每个环境族定义一个“外部性强度标量” \(E\)（例如相关系数 ρ、隐私担忧 ρ、匿名化信息损失、平台数 n 等）
  - 抽样时做 `low / mid / high` 三桶，保证难度梯度
- **规模控制**
  - 每族 200–1000 个实例（先小后大）
  - 每个实例每种配置跑 ≥10 次重复，出 CI
- **对照组**
  - 全理性（理论/算法策略）
  - 全 LLM 同质
  - 异质（消费者弱/企业强，或反之）
  - 可选：仅替换某一阶段（诊断“偏差来源”）

---

### 5) 评分与报表（统一输出格式）

#### 5.1 主评分：Outcome Deviation（ICDE-style）

- 对每个环境族定义 5–8 个核心指标集合 \(Q\)
- 每个模型 M 的总分由 \( \{MAE(M,q)\}_{q\in Q}\) 组成（可做归一化与加权汇总）
- 统计：对每个 \(MAE(M,q)\) 输出 68%/90% CI

#### 5.2 辅评分：Decision Quality（可行性 + 约束）

- 约束违反率（例如价格 < 成本、输出非 JSON、动作越界）
- 一致性（同一状态多次调用行动分布的稳定性）

#### 5.3 解释评分：Explainability（可复现）

- **要点覆盖**：每族 6–10 条 keypoints（必须出现的机制链）
- **硬错误清单**：出现即重扣（如“匿名化允许个性化定价”“推断外部性来自正外部性”等）
- **稳定性**：同输入 5 次取众数（ICDE 的做法），并报告 Kendall/Jaccard

---

### 6) Prompt 与输出约束（只给 LLM 做“行动”）

- **统一输出 JSON（强约束）**
  - Decision：`{"action": ...}`（二元/离散/小向量）
  - Explain：`{"keypoints":[...], "factor_ranks":{...}, "decision_chain":[...]}`
- **不要求 LLM 输出**：均衡解、积分推导、阈值公式、福利分解数值（这些都交给 solver）

---

### 7) 最短落地路径（不写代码版本的执行顺序）

- **第一步（最快复现 ICDE）**：环境族 A 完整复刻，并把“同质/异质/阶段开关 + MAE+CI + 解释管线”跑通
- **第二步（机制最接近 A）**：环境族 B（Too Much Data），用小 n 枚举确保理论基准可靠
- **第三步（信息政策）**：环境族 C（Social Data），重点做匿名化一致性与命题一致性标签
- **第四步（两边市场传导）**：环境族 D，输出 regime_label + 传导链解释评分
- **最后（可选）**：环境族 E 作为扩展章

---

### 8) 你现有总结与本方案的“关键差异”（一句话版）

- **从“让 LLM 报结果/报均衡”** → **改为“让 LLM 做行动，环境算结果”**
- **从“指标工具箱”** → **收敛为“MAE vs 理论基准 + CI”作为主轴**
- **从“容易重新建模”** → **强制 MEM 忠实论文原语，新增假设要做敏感性对照**

