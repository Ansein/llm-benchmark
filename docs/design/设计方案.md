下面给出一套“可以直接生成 benchmark 实例”的设计清单，覆盖你们五个场景（含 Personalization）。我会**按你原文件相同模板**写：Solver 设计、输入参数、解算步骤、输出数值（ground truth）、如何抽象成可评测标签（labels），以及建议的 LLM 题目字段（你们后面写 evaluator 会直接用）。

但整体思想会改成与 ICDE baseline 一致的“新方案”：

- **LLM 负责做行动决策**（share / price / search / anonymize / partner…），不要要求它直接报均衡、阈值或精确福利分解；
- **Solver 负责算理论基准**（BNE/first-best/政策基准）与可评分的数值后果；
- **主评分是“偏离理论基准”**：对关键指标 \(q\) 计算 **MAE vs \(q^*\)**，并用多次重复给 CI（68%/90% 或 bootstrap）；
- **同质 vs 异质 + 阶段开关**：像 ICDE 一样可按阶段替换（share/price/search…），并比较同质部署与异质部署；
- **解释题可复现**：要点表 + 因子重要性分档 + 决策链条抽取（多次调用取众数 + Kendall/Jaccard 稳定性）。

为保证可落地与可复现，我仍然坚持“最小但完整（minimal yet complete）”：小规模、离散动作优先、能枚举就枚举，连续变量用数值最优化但控制维度。

一、统一约定（所有场景通用）

1）Instance（一个 benchmark 样本）建议统一包含：

* instance_id：场景名 + seed + 参数 hash
* params：该场景参数字典（含外部性强度分桶字段，便于分层统计）
* rules：简短可读的规则描述（给 LLM）
* theory_baseline：理论基准（例如 BNE/FB/政策基准的关键数值）
* gt_numeric：求解器输出的全量数值真值（给 evaluator / 复现用）
* gt_labels：从数值真值抽象出来的标签（给自动评分用：结构/方向/排序/桶化）
* keypoints_gold：机制要点集合（解释题 rubric）
* hard_errors：解释题/逻辑一致性硬错误清单（出现即重扣）

2）求解器输出（gt_numeric）与标签（gt_labels）的关系：

* gt_numeric 尽量“全量记录”（便于以后加新标签、新分析）
* gt_labels 只保留“LLM 需要回答且能稳定评分的字段”（结构/方向/排序/桶化，不要逼 LLM 报精确数值）

3）统一三类任务（建议所有场景都生成）

* Decision（行动）：LLM 输出严格 JSON 的 action（可行性检查 + 约束违反率）
* Deviation（主评分）：环境跑完得到指标向量 \(q\)，与理论基准 \(q^*\) 做 MAE；按配置重复 ≥10 次给 CI
* Explain（解释）：LLM 输出 keypoints / factor_ranks / decision_chain；用要点覆盖 + 硬错误 + 稳定性评分

4）统一配置开关（对齐 ICDE）

* homogeneous：消费者与企业同一 LLM
* heterogeneous：消费者弱/企业强（或反之），或混合理性/LLM
* stage_switch：按阶段替换（share / price / search / 其它场景阶段）

下面进入各场景。

二、场景 A：Personalization & Privacy Choice（Rhodes & Zhou / ICDE baseline，隐私选择外部性）

A1. 模型定位
外部性来源：消费者分享数据会改变企业定价与搜索摩擦，从而影响其他消费者的剩余；个体在做隐私选择时不内生其对市场价格/他人搜索的影响，导致**过度分享**。该场景应尽量对齐 ICDE baseline 的三阶段（share→price→search）。

A2. 输入参数（对齐 ICDE / Rhodes-Zhou）

* N：消费者数（建议 20–200，用于仿真统计；也可更小用于快速迭代）
* n：企业数（关键“竞争强度”参数；建议 {2,5,10} 或网格扫参）
* F：消费者对企业 i 的估值分布（例如 Uniform[v_low, v_high]，与 ICDE 常用设定一致）
* c：企业边际成本
* s：搜索成本（每多探查一家企业的成本）
* r：保留值（由 \(\int_r^{\bar v}(1-F(v))dv=s\) 定义；可在 solver 里由 F 与 s 计算）
* T(·)：隐私成本 τ 的分布（如 Uniform[τ_low, τ_high]）
* Tmax：仿真轮数（如 30–200），用于 MAE 与 CI

A3. Solver 设计（两类输出：理论基准 + 可跑仿真环境）

（1）理论基准：BNE \((\sigma^*, p^*)\)（与 ICDE 一致）

* 给定对称价格 p，分享净收益 \(\Delta(p)=V_s(p)-V_a(p)\)，从而阈值 \(\hat\tau(p)\) 与分享率 \(\sigma(p)=T(\hat\tau(p))\)（Rhodes & Zhou 的闭式定义）
* 给定分享率 σ，企业在对称竞争下解价格最优（FOC 或 best-response 固定点求 \(p^*(\sigma)\)）
* 固定点迭代：\(\sigma \leftarrow \sigma(p)\)，\(p \leftarrow p^*(\sigma)\)，直至收敛得到 \((\sigma^*,p^*)\)

（2）仿真环境：每轮 share→price→search（与 ICDE 的 stage switch 对齐）

* share 阶段：
  - 理性策略：消费者 i 分享当且仅当 \(\Delta(p_{t-1,avg})>\tau_i\)
  - LLM 策略：LLM 输出 `{"share":0/1}`（输入包含 τ_i、n、s、r、上一轮平均价等）
* price 阶段：
  - 理性策略：企业解对称或近似 best response 得到 \(p_t\)
  - LLM 策略：LLM 输出 `{"price": number}`（约束：price ≥ c）
* search 阶段：
  - 理性策略：匿名消费者按保留值规则停止；分享者按推荐排序（best-first）购买
  - LLM 策略：LLM 输出 stop/buy/continue（或直接输出访问顺序与停止点）
* 每轮计算指标向量 \(q_t=\{\sigma_t,p_{avg,t},SC_t,S_{c,t},S_{f,t},SW_t\}\)

A4. 输出数值（gt_numeric）

* theory_bne：\(\sigma^*, p^*\) 以及对应的理论基准指标 \(q^*\)（至少包含 σ、pavg、SC、Sc、Sf、SW）
* primitives：F、T、(n,c,s) 等用于复现
* helper_funcs：\(\Delta(p)\)、\(\sigma(p)\)、定价 best-response 的数值解细节（记录求解容差与迭代次数）

> 注：LLM 运行出来的 per-round 指标属于“实验输出”，不应写死在 gt_numeric 里；但理论基准 \(q^*\) 必须写进 instance，便于 evaluator 计算 MAE。

A5. 抽象标签（gt_labels）

* competition_bucket：由 n 分桶（low/med/high competition）
* externality_strength_bucket：由 \(\sigma^*\) 或 \(\partial p/\partial \sigma\) 的数值强度分桶（可选）
* over_sharing_label：与社会最优或某个政策基准对比的“过度分享”方向（若你实现 FB/政策）
* theory_targets：把 \(q^*\) 的关键分量也放入 labels（方便 evaluator 直接读取）

A6. 建议 LLM 题目字段（严格 JSON，做行动，不报推导）

* share：`{"share":0/1, "rationale": "...(可选)..." }`
* price：`{"price": <float>, "rationale": "...(可选)..." }`
* search：`{"action":"continue|buy|stop", "observed":[...], "rationale":"..." }`
* explain：`{"keypoints":[...], "factor_ranks":{...}, "decision_chain":[...]}`

三、场景 B：Too Much Data（推断外部性/信息外部性，对齐论文 leaked information）

B1. 模型定位
外部性来源：用户类型相关，他人分享提升平台对你类型的推断精度，即使你不分享也会被“连带泄露”；边际信息可能次模导致价格压低与过度分享。

B2. 输入参数

* n：用户数（建议 8–12，保证 $2^n$ 可枚举）
* $\Sigma$：类型相关协方差矩阵（可用等相关：$\Sigma[i,j]=\rho$（$i\neq j$），$\Sigma[i,i]=1$）
* $\sigma^2$：观测噪声方差（分享者信号 $S_i=X_i+\varepsilon$）
* $\alpha$：平台从信息中获益系数
* $v_i$：每个用户隐私偏好（泄露成本系数）
* market_mechanism：定价/交易规则（建议用“平台对分享者支付价格 $p_i$，用户决定分享”）

B3. Solver 设计（枚举分享集合 + 理论基准 + 政策反事实；LLM 输出 action 而非数值）
核心计算：给定分享集合 $S$，计算对所有 $i$ 的“泄露信息量”

* 观测矩阵 $H$：选取 $S$ 中坐标
* 后验协方差：$\Sigma_{\text{post}} = \Sigma - \Sigma H^T (H\Sigma H^T + \sigma^2 I)^{-1} H\Sigma$
* $\text{leak}_i(S)=\Sigma[i,i]-\Sigma_{\text{post}}[i,i]$

平台价值：$\text{Value}(S)=\alpha \cdot \sum_i \text{leak}_i(S)$
用户隐私成本：$\text{Cost}_i(S)=v_i \cdot \text{leak}_i(S)$
社会福利：$W(S)=\text{Value}(S)-\sum_i \text{Cost}_i(S)$

理论基准（建议第一版用“小 n 枚举 + 机制简化但可复现”的实现）

你需要一个明确的交易规则来定义均衡。为了可跑、可复现且与论文主结论一致，第一版建议用：

* 平台向用户提供 take-it-or-leave-it 价格 \(p_i\)，用户选择 share_i∈{0,1}
* 给定一个候选分享集合 S，用参与约束构造“支持 S”的最小价格：

* 对 $i\in S$：需要 $p_i \geq v_i \cdot \text{leak}_i(S)$（分享者至少补偿其最终隐私成本；第一版用这个充分条件即可）
* 对 $i\notin S$：需要 $0 \geq - v_i \cdot \text{leak}_i(S)$（他们不拿钱但也承受泄露；因此他们永远更愿意“不分享”，因为分享只会额外增加泄露/且无额外收益；在该简化下，不分享者不会偏离去分享，条件自然满足）
  据此平台利润：$\Pi(S)=\text{Value}(S)-\sum_{i\in S} p_{i,\text{min}}$

选择：$S^* = \arg\max \Pi(S)$，得到均衡分享集合与价格下界。

说明：这个“\(p_i=v_i\cdot leak_i(S)\)”是一个稳定、可计算的实现（参与约束的充分条件），适合作为 benchmark 的可靠真值。后续如果你们要更贴近论文的完整机制（例如更精细的均衡选择），再升级也不影响第一版结论链条（相关性→推断外部性→价格压低→过度分享）。

B4. 输出数值（gt_numeric）

* eq_share_set $S^*$
* eq_prices $p_i$（最小支持价）
* eq_value、eq_profit、eq_W、eq_total_leakage
* fb_share_set（最大化 $W(S)$ 的集合）
* fb_W、fb_total_leakage
* shutdown_W（$S=\varnothing$ 的福利）
* policy_counterfactuals：shutdown / pigouvian_tax / decorrelation 下的 {eq, fb}（若实现）
* theory_targets：作为偏离评分的基准 \(q^*\)（至少包含 share_rate、avg_data_price、total_leakage、CS、PS、W）

B5. 抽象标签（gt_labels）

* over_sharing：$1\{|S^*| > |S_\text{fb}|\}$
* shutdown_better：$1\{W(\varnothing) > W(S^*)\}$
* leakage_bucket：按 $\sum_i \text{leak}_i(S^*)$ 分桶 low/med/high
* best_policy_ranking：在 {tax, shutdown, decorrelation} 中按 $W$ 排序（若实现政策）

B6. 建议 LLM 题目字段（做行动/方向，不报精确矩阵运算）

* share 决策：`{"share":0/1}`（给定自身 v_i 与环境摘要）
* 机制题：必须说清“你不分享也会因为别人分享而泄露”（推断外部性）与“次模性→边际价值下降→压低价格”
* 政策题：输出 shutdown/tax/decorrelation 的福利排序（不要求报精确福利数值）

四、场景 C：Economics of Social Data（社会数据、匿名化/身份信息；Proposition 8 方向）

C1. 模型定位
外部性来源：个体数据具有社会性（反映共同成分/市场状态）。数据中介的“匿名化 vs 带身份”是信息设计，会改变卖家定价能力与福利。

C2. 输入参数（第一版选可计算的简化）

* N：消费者数（建议 50–500，用模拟期望）
* $w_i = \theta + \eta_i$：愿付分解
* $\theta \sim N(\mu, \sigma_\theta^2)$，$\eta_i \sim N(0, \sigma_\eta^2)$
* 观测噪声 $\varepsilon_i \sim N(0, \sigma_\varepsilon^2)$，信号 $s_i = w_i + \varepsilon_i$
* 两种信息模式：

  * A（匿名化）：卖家仅观察 $\bar{s}$（或 $\theta$ 的后验）
  * I（带身份）：卖家观察每个 $i$ 的 $s_i$ 并可差别定价
* 需求/购买规则：买当且仅当 $w_i \geq \text{price}$（或差别价下 $w_i\geq p_i$）
* 成本 cost

C3. Solver 设计（两种数据政策 A/S + 定价形式一致性；以“模式选择标签 + 福利”做真值）
模式 A（匿名化）：

* 卖家基于 $\bar{s}$ 更新对 $\theta$ 的后验（可用正态共轭闭式）
* 给定后验，卖家选择统一价 $p$ 最大化期望利润 $E[(p-\text{cost})\cdot \#\text{buyers}]$
* 通过网格搜索 $p$（例如在 $[0,1]$ 或 $[\mu\pm3\sigma]$ 上网格）得到 $p_A^*$

模式 I（带身份）：

* 卖家对每个 $i$ 形成 $E[w_i\mid s_i]$（正态更新闭式）
* 差别定价最简单可设为 $p_i = E[w_i\mid s_i]$（一阶近似），或加入一个统一折扣 $\delta$ 保证购买概率（你可用 $p_i = E[w_i\mid s_i] - \kappa$ 作为政策参数并数值选 $\kappa$ 最大化利润）
* 得到利润 $\Pi_I$、消费者剩余 $CS_I$、福利 $W_I$

中介选择（与论文表述对齐）：

* 数据政策 \(X\in\{S(带身份),A(匿名)\}\)
* 在“匿名化”下，卖家只能基于市场级信息设统一/组价，**不能做个体差别定价**（作为硬一致性约束）
* 真值重点：在你设定的同质条件/数据结构下，(i) 中介最优是否匿名化；(ii) 匿名化是否提升社会剩余；(iii) 两者是否同向（命题一致性标签）

C4. 输出数值（gt_numeric）

* $p_A^*$、$\Pi_A$、$CS_A$、$W_A$
* （带身份）差别定价策略参数（如 $\kappa^*$）、$\Pi_I$、$CS_I$、$W_I$
* mode_welfare_best：$\arg\max\{W_A,W_I\}$
* mode_profit_best：$\arg\max\{\Pi_A,\Pi_I\}$ 或中介利润版本
* proposition8_holds：$1\{ (\text{profit\_best}==A) \equiv (\text{welfare\_best}==A) \}$（作为一致性标签；具体命题编号按你们最终复核论文写法）

C5. 抽象标签（gt_labels）

* best_mode_welfare：A 或 I
* best_mode_profit：A 或 I
* proposition8_label：true/false
* personalization_possible：匿名化下必须为 false（一致性硬约束标签）
* $\Delta CS_\text{sign}$：$\text{sign}(CS_A - CS_I)$

C6. 建议 LLM 题目字段（强调一致性硬约束）

* 一致性题：`{"anonymization_supports_personalized_pricing": false}`（必须为 false）
* 模式判断：`{"best_mode_welfare":"A|S", "best_mode_profit":"A|S", "prop8_holds":true/false}`
* 机制要点：必须提“社会数据外部性来自预测他人”“匿名化=市场级信息”

五、场景 D：Data-enabled Learning（动态学习、竞争、预期政策；可选扩展场景）

D1. 模型定位（可选：若你主线要覆盖“动态政策预期/一般均衡推理”，再纳入）
外部性来源：今天的数据积累提升未来产品质量，消费者当前选择改变未来竞争格局；政策若可预期，会改变企业前期竞争强度（补贴/降价动机）。

D2. 输入参数（第一版做有限期动态，离散状态）

* T：期数（建议 15–30）
* 两企业 $i\in\{I,E\}$
* 学习状态 $N_i(t)$（服务量/数据存量，离散 $0..K$）
* 学习函数 $f(N)=a\cdot\log(1+N)$ 或 $a\cdot\sqrt{N}$
* 消费者基准偏好差 $\Delta_0$（可设 0）
* 噪声/随机偏好（可选：Logit，或简化为确定性选择）
* 成本 $c$，折扣 $\beta$
* 政策：在 $t_0$ 发生数据共享转移（把领先者一部分状态转给落后者），分 anticipated 与 unanticipated 两种信息结构

D3. Solver 设计（动态规划 + 每期一阶段纳什；重点输出“anticipated vs unanticipated”方向标签）
状态 $s=(N_I,N_E,t)$：

* 给定状态与对方价格，消费者选择（确定性：选效用更高者；或 Logit：市场份额连续）
* 企业一阶段利润：$\pi_i(p_i,p_{-i},s)=(p_i-c)\cdot q_i$
* 状态转移：$N_i’=N_i + q_i$（或 +1 若赢得该期消费者）

求解方式：

* 价值函数迭代（后向归纳，有限期最稳）：

  * $V_i(s)=\max_{p_i} \left[ \pi_i + \beta \cdot V_i(s’) \right]$
  * 其中 $(p_i,p_{-i})$ 是当期一阶段纳什：两边互为 best response
* 一阶段纳什求解：因只有一维价格，可用网格或一维最优化 + best response 迭代（价格区间离散化更稳）
* 对 anticipated 政策：在 $t<t_0$ 的递推里使用“已知 $t_0$ 会发生转移”的转移规则
* 对 unanticipated：先按无政策递推到 $t_0-1$，$t_0$ 突然改变状态，再继续递推（或直接模拟策略路径）

D4. 输出数值（gt_numeric）

* 价格路径 $p_I(t), p_E(t)$
* 市场份额路径 $q_I(t), q_E(t)$
* 终局赢家（谁的 $N$ 更大/累计利润更高）
* CS 总和（折现或不折现）、$\Pi$ 总和、$W$ 总和
* policy outcomes：anticipated vs unanticipated 下的 $CS$、$W$
* $\Delta CS_{\text{anticipated}}$、$\Delta CS_{\text{unanticipated}}$

D5. 抽象标签（gt_labels）

* winner_label：I 或 E
* anticipated_policy_CS_sign：$\text{sign}(CS_{\text{policy}} - CS_{\text{baseline}})$
* unanticipated_policy_CS_sign：$\text{sign}(CS_{\text{policy}} - CS_{\text{baseline}})$
* anticipation_gap_sign：$\text{sign}( (CS_{\text{unanticipated\_gain}}) - (CS_{\text{anticipated\_gain}}) )$
* subsidy_intensity_bucket：用前几期平均 $(c - p_i)$ 的大小分桶（衡量“补贴竞争强度”）

D6. 建议 LLM 题目字段（方向/结构为主）

* 输出赢家（I/E）、两种政策下 \(\Delta CS\) 的符号、哪种更利于消费者
* 机制要点：必须解释“政策可预期会削弱前期补贴/降价动机，可能降低 CS”

六、场景 E：Platform–Data Broker Partnership（两边市场传导 + 合作博弈；对齐论文反直觉结论）

E1. 模型定位
外部性来源：平台与 broker 合作提升定向能力（广告侧价值↑），同时提升隐私担忧（消费者侧效用↓）。隐私担忧会反馈到广告侧竞争与价格，可能出现“隐私越担忧越合作”的反直觉动机。

E2. 输入参数（第一版用两阶段、可数值求）

* 两平台 A/B
* 合作决策 $y_i\in\{0,1\}$
* $\delta$：定向能力提升幅度（合作收益）
* $\rho$：隐私担忧强度（合作成本/消费者侧负效应）
* $\gamma$：给 broker 的佣金/固定费
* 消费者侧需求参数：基础规模 $M$、差异化程度 $t$
* 广告侧需求参数：广告主愿付与用户规模的函数（线性即可）
* 商业模式：ad_only 或 mixed（mixed 允许平台对消费者收订阅价）

E3. Solver 设计（外层枚举合作结构，内层求定价均衡；输出 regime_label 与传导链标签）
外层：枚举 $(y_A,y_B)\in\{(0,0),(1,0),(0,1),(1,1)\}$

内层定价子博弈（给定 $y$）：

* 选择变量：

  * ad_only：广告价 $r_A,r_B$
  * mixed：广告价 $r_i +$ 订阅价 $s_i$
* 需求系统（示例，第一版可用确定性 Hotelling 的简化近似或连续近似）：

  * 消费者效用：$U_i = \text{base} - t\cdot\text{distance} - \rho\cdot y_i - s_i$
  * 得到用户份额 $n_i$（可用 Logit 近似避免分段）
  * 广告需求：$A_i = k\cdot(\beta+\delta\cdot y_i)\cdot n_i - m\cdot r_i$（线性反应）
* 平台利润：$\Pi_i = r_i\cdot A_i + s_i\cdot n_i - \gamma\cdot y_i$

求解方法：

* 对内层连续变量，用数值 best-response 或直接多变量优化（维度 2 或 4，仍可控）
* 多初值启动以避免局部最优
* 得到每个 $y$ 下的均衡利润 $\Pi_i(y)$、价格、用户份额

第一阶段合作均衡：

* 用利润矩阵判断 $2\times2$ 博弈的纯策略纳什（或若无纯策略，标记混合均衡但第一版可选参数区间避免）
* 得到 $(y_A^*,y_B^*)$：NN/YN/YY 等结构标签

E4. 输出数值（gt_numeric）

* regime_eq：NN/YN/NY/YY
* 每种 $y$ 下：$r_i$、（可选 $s_i$）、用户份额 $n_i$、广告量 $A_i$、利润 $\Pi_i$
* 均衡下：价格、份额、利润、$CS$、$W$（你可以把消费者效用积分作为 $CS$）
* 对比：在不同 $\rho$、$\delta$ 下 regime 变化阈值（用于画相图）

E5. 抽象标签（gt_labels）

* regime_label：NN / YN / YY（若对称可把 NY 合并）
* ad_price_sign_wrt_privacy：在固定 \(\delta\) 下，提高 \(\rho\) 是否使均衡广告价上升（软化竞争方向标签）
* consumer_welfare_effect_of_coop：合作相对不合作对 $CS$ 的符号（并按 ad_only vs mixed 区分）
* prisoner_dilemma_flag：若 YY 为均衡但 NN 的双边福利更高（或消费者更高），标记为 1

E6. 建议 LLM 题目字段（结构/方向/一致性）

* 输出均衡合作结构（NN/YN/YY）、隐私担忧上升对广告价方向、合作对消费者是否更糟（区分 ad_only vs mixed）
* 机制要点：必须包含“负跨边网络效应→为避免用户流失→广告侧竞争软化→广告价上升”

七、你们如何把这些“实例”组织成可跑的 benchmark 生成流程（对齐新方案）

1）每个场景写一个 generator：

* sample_params(seed) 生成 params
* build_rules_text(params) 生成给 LLM 的题干（严格控制长度与信息）
* build_instance(params) 返回 instance

2）每个场景写一个 solver（必须包含 theory baseline 输出）：

* solve_theory(instance) -> theory_baseline + gt_numeric
* abstract(gt_numeric) -> gt_labels
* attach keypoints_gold（固定模板 + 条件触发要点）

3）每个场景定义一组任务模板（给 evaluator；与 ICDE 一致的三类任务）：

* Decision：输出 action（share/price/search/partner/…），检查可行性与约束违反率
* Deviation：输出指标向量 \(q\) 并计算 MAE vs \(q^*\)；配置重复 ≥10 输出 CI
* Explain：输出 keypoints/factors/chains（要点覆盖 + 硬错误 + 稳定性）

八、你可以立刻启动的最小落地版本（强烈建议按这个顺序；对齐 ICDE 跑法）

第一周先做两件事跑通全链路：
1）Personalization（Rhodes & Zhou / ICDE）：三阶段 share→price→search + 理论 BNE 基准 + MAE+CI（把 stage_switch / homogeneous / heterogeneous 也打通）
2）Too Much Data：小 n 枚举 + leaked information（MSE 降低）+ shutdown/tax/decorrelation 反事实（至少做 shutdown 与 tax）

这两者最贴近“隐私外部性”主线，且真值稳定，适合作为 benchmark 的第一批样本；之后再做 Social Data 与平台-数据经纪人两边市场场景。

如果你希望我下一步继续把这些“方案”进一步变成你们仓库可直接实现的代码级骨架（类/函数签名、JSON schema、以及每个场景一份伪代码到可运行代码的对应），我可以从你们最优先的两个场景（Personalization、Too Much Data）开始，给出一版“最小可运行”实现蓝图，方便你们直接落地到现有 ICDE 代码框架里。