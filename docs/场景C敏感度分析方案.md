# 场景C敏感度分析方案

## 背景

场景C研究的是社会数据市场中，数据中介、消费者和生产者三方博弈的均衡问题。核心参数包括：
- **数据结构**：Common Preferences vs Common Experience
- **隐私敏感度**：τ的分布（均值和标准差）
- **信号噪声**：σ（影响数据质量）
- **补偿机制**：m（影响参与率）

## 场景B vs 场景C 参数对比

### 场景B（已完成）
- **ρ**（相关系数）: {0.3, 0.6, 0.9} - 3个值
- **v范围**（隐私偏好）: {[0.3,0.6], [0.6,0.9], [0.9,1.2]} - 3个范围
- **参数组合**: 3×3 = 9组
- **模型数**: 12个
- **重复次数**: 3次
- **总实验数**: 9×12×3 = 324次

### 场景C（待设计）
场景C的参数空间更复杂，需要权衡覆盖度和成本。

## 推荐方案：3×3敏感度网格

### 方案A：隐私敏感度 × 信号噪声（推荐）

**核心思想**：考察消费者异质性（τ）和数据质量（σ）对均衡的影响

#### 参数设置

1. **隐私敏感度均值 τ_mean**: {0.5, 1.0, 1.5}
   - **0.5**: 低隐私敏感度（更愿意分享）
   - **1.0**: 中等隐私敏感度（基准）
   - **1.5**: 高隐私敏感度（更谨慎）

2. **信号噪声 σ**: {0.5, 1.0, 2.0}
   - **0.5**: 高质量信号（低噪声）
   - **1.0**: 中等质量信号（基准）
   - **2.0**: 低质量信号（高噪声）

3. **固定参数**:
   - N = 20（消费者数）
   - data_structure = 'common_preferences'（论文主场景）
   - tau_std = 0.3（隐私异质性标准差）
   - mu_theta = 5.0（先验均值）
   - sigma_theta = 1.0（先验标准差）
   - c = 0.0（边际成本）

#### 参数组合矩阵

|       | σ=0.5 (高质量) | σ=1.0 (中质量) | σ=2.0 (低质量) |
|-------|---------------|---------------|---------------|
| **τ=0.5** | (1) 低敏感×高质量 | (2) 低敏感×中质量 | (3) 低敏感×低质量 |
| **τ=1.0** | (4) 中敏感×高质量 | (5) 中敏感×中质量 | (6) 中敏感×低质量 |
| **τ=1.5** | (7) 高敏感×高质量 | (8) 高敏感×中质量 | (9) 高敏感×低质量 |

#### 理论预期

1. **τ的影响**：
   - τ↓ → 更多消费者愿意参与 → 中介利润↑、社会福利↑
   - τ↑ → 参与率下降 → 可能无法达成交易

2. **σ的影响**：
   - σ↓（高质量）→ 生产者估计更准确 → 价格歧视更有效（实名）
   - σ↑（低质量）→ 信号噪声大 → 匿名化优势减弱

3. **交互效应**：
   - 低τ×低σ：最佳场景，高参与率+高质量数据
   - 高τ×高σ：最差场景，低参与率+低质量数据

#### 实验配置

```python
# 参数网格
tau_mean_values = [0.5, 1.0, 1.5]
sigma_values = [0.5, 1.0, 2.0]

# 固定参数
params_base = {
    'N': 20,
    'data_structure': 'common_preferences',
    'tau_std': 0.3,
    'mu_theta': 5.0,
    'sigma_theta': 1.0,
    'c': 0.0,
    'participation_timing': 'ex_ante',
}

# 总实验数
# 9组参数 × 12个模型 × 3次重复 = 324次实验
```

---

## 方案B：数据结构 × 隐私敏感度（备选）

**核心思想**：比较两种数据结构在不同隐私敏感度下的表现

#### 参数设置

1. **数据结构**: {common_preferences, common_experience}
2. **隐私敏感度 τ_mean**: {0.5, 1.0, 1.5}
3. **信号噪声 σ**: 固定为1.0

这样得到 2×3 = 6组参数组合。

**优点**：更全面地覆盖两种数据结构
**缺点**：实验数较少（6组），且两种数据结构差异较大可能难以直接比较

---

## 方案C：多维度小规模探索（折中）

**核心思想**：在关键维度各选2个值，快速探索

#### 参数设置

1. **隐私敏感度 τ_mean**: {0.7, 1.3}（低/高）
2. **信号噪声 σ**: {0.7, 1.5}（高质量/低质量）
3. **隐私异质性 tau_std**: {0.2, 0.4}（同质/异质）

这样得到 2×2×2 = 8组参数组合。

**优点**：探索3个维度
**缺点**：覆盖度不如3×3，难以看到清晰的趋势

---

## 最终推荐：方案A

### 理由

1. **与场景B一致**：同样采用3×3网格，便于比较和可视化
2. **理论意义清晰**：τ和σ是场景C的两个核心参数
   - τ：消费者端（参与决策）
   - σ：数据质量（生产者端）
3. **覆盖度合适**：9组参数可以看到明显的趋势变化
4. **计算成本可控**：324次实验（与场景B相同）

### 实施步骤

1. **生成Ground Truth**：
   ```bash
   python scripts/generate_scenario_c_sensitivity_gt.py
   ```
   
2. **运行敏感性实验**：
   ```bash
   python run_sensitivity_c.py --models [12个模型] --num-trials 3
   ```

3. **分析结果**：
   ```bash
   python analyze_sensitivity_results_c.py
   ```

### 预期输出

每组参数生成一个GT文件：
```
data/ground_truth/sensitivity_c/
├── scenario_c_tau0.5_sigma0.5.json
├── scenario_c_tau0.5_sigma1.0.json
├── scenario_c_tau0.5_sigma2.0.json
├── scenario_c_tau1.0_sigma0.5.json
├── scenario_c_tau1.0_sigma1.0.json  # 基准
├── scenario_c_tau1.0_sigma2.0.json
├── scenario_c_tau1.5_sigma0.5.json
├── scenario_c_tau1.5_sigma1.0.json
└── scenario_c_tau1.5_sigma2.0.json
```

## 扩展方案（如果资源充足）

### 方案D：4×3网格（48组）

如果想要更细粒度的分析，可以考虑：

1. **隐私敏感度 τ_mean**: {0.4, 0.8, 1.2, 1.6} - 4个值
2. **信号噪声 σ**: {0.5, 1.0, 2.0} - 3个值

总实验数：12×12×3 = 432次

---

## 技术细节

### GT生成注意事项

1. **优化方法**：使用混合优化（网格搜索 + scipy）确保找到全局最优
2. **MC采样数**：建议30-50个样本以确保稳定性
3. **固定点迭代**：20轮应该足够收敛
4. **随机种子**：每个参数组合使用不同的seed以避免偶然性

### 评估配置

场景C有多种评估配置，敏感性分析建议使用：
- **配置D_FP**：LLM中介 × LLM消费者（虚拟博弈）
- 50轮虚拟博弈
- 信念窗口 = 10

### 结果指标

关键评估指标：
1. **参与率准确度**：LLM预测的参与率 vs GT
2. **补偿策略偏差**：|m_LLM - m_GT|
3. **匿名化策略准确度**：是否选择正确的匿名化策略
4. **利润偏差**：|Profit_LLM - Profit_GT|
5. **社会福利偏差**：|SW_LLM - SW_GT|

---

## 总结

**推荐方案A**：
- 参数：τ_mean ∈ {0.5, 1.0, 1.5} × σ ∈ {0.5, 1.0, 2.0}
- 9组参数 × 12个模型 × 3次重复 = 324次实验
- 与场景B的规模一致，便于对比分析

**下一步**：
1. 确认方案
2. 编写GT生成脚本
3. 编写敏感性实验控制器
4. 运行实验
5. 可视化分析
